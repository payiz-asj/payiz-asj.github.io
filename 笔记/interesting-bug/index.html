<!DOCTYPE html>


<html lang="zh-CN">
  

    <head>
      <meta charset="utf-8" />
       
      <meta name="keywords" content="YeYing,Blog,å¤œèº,åšå®¢,å¤œèºæ‚ åŸ,yeying.tech,www.yeying.tech" />
       
      <meta name="description" content="æŒ‘ç¯å¤œæˆ˜ï¼Œå¸¸é—»å¤œèºæ‚ åŸ...åœç¬”å…±é¸£...æ‚²å£®ã€åšå®šï¼&lt;br&gt;å¿ƒé…¸èƒŒåæ€»æœ‰å€¼å¾—åšæŒçš„ç†ç”±ğŸ’ªè¯·åšæŒï¼&lt;br&gt; çæƒœèº«è¾¹çš„äººï¼ å°å¿«yä½ â¤" />
      
      <meta
        name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1"
      />
      <title>ä¸€ä¸ªå¾ˆå¥‡æ€ªçš„BUG |  å¤œèºæ‚ åŸ</title>
  <meta name="generator" content="hexo-theme-ayer">
      
      <link rel="shortcut icon" href="/favicon.ico" />
       
<link rel="stylesheet" href="/dist/main.css">

      <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/Shen-Yu/cdn/css/remixicon.min.css"
      />
      
<link rel="stylesheet" href="/css/custom.css">
 
      <script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>
       
 

      <!-- mermaid -->
      
    <link rel="alternate" href="/atom.xml" title="å¤œèºæ‚ åŸ" type="application/atom+xml">
</head>
  </html>
</html>


<body>
  <div id="app">
    
      
    <main class="content on">
      <section class="outer">
  
<article
  id="post-interesting-bug"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h1 class="article-title sea-center" style="border-left:0" itemprop="name">
  ä¸€ä¸ªå¾ˆå¥‡æ€ªçš„BUG
</h1>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/%E7%AC%94%E8%AE%B0/interesting-bug/" class="article-date">
  <time datetime="2021-08-30T10:11:39.000Z" itemprop="datePublished">2021-08-30</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E7%AC%94%E8%AE%B0/">ç¬”è®°</a>
  </div>
  
<div class="word_count">
    <span class="post-time">
        <span class="post-meta-item-icon">
            <i class="ri-quill-pen-line"></i>
            <span class="post-meta-item-text"> å­—æ•°ç»Ÿè®¡:</span>
            <span class="post-count">2.5k</span>
        </span>
    </span>

    <span class="post-time">
        &nbsp; | &nbsp;
        <span class="post-meta-item-icon">
            <i class="ri-book-open-line"></i>
            <span class="post-meta-item-text"> é˜…è¯»æ—¶é•¿â‰ˆ</span>
            <span class="post-count">10 åˆ†é’Ÿ</span>
        </span>
    </span>
</div>
 
    </div>
      
    <div class="tocbot"></div>




  
    <div class="article-entry" itemprop="articleBody">
       
  <h2 id="ä¸€ä¸ªå¾ˆå¥‡æ€ªçš„BUG"><a href="#ä¸€ä¸ªå¾ˆå¥‡æ€ªçš„BUG" class="headerlink" title="ä¸€ä¸ªå¾ˆå¥‡æ€ªçš„BUG"></a>ä¸€ä¸ªå¾ˆå¥‡æ€ªçš„BUG</h2><h3 id="å‘ç°Bug"><a href="#å‘ç°Bug" class="headerlink" title="å‘ç°Bug"></a>å‘ç°Bug</h3><p>ä»Šå¤©åœ¨ä½¿ç”¨python+win32comè¯»å–exelè¡¨æ ¼æ—¶ï¼Œçªç„¶é‡åˆ°ä¸€ä¸ªbugï¼Œè·å–ä¸åˆ°exelæƒé™ï¼Œå³ç¨‹åºç¬¬ä¸€å¥å°±å‡ºé”™ï¼Œåé¢çš„å†…å®¹éƒ½æ— æ³•è¿è¡Œï¼Œæ¯”å¦‚ä¸‹é¢å†™äº†ä¸€ä¸ªç®€å•çš„æµ‹è¯•ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> win32com.client</span><br><span class="line"></span><br><span class="line">xlApp = win32com.client.Dispatch(<span class="string">&#x27;Excel.Application&#x27;</span>)  <span class="comment"># win32comè·å–exelåº”ç”¨æœåŠ¡</span></span><br><span class="line">filename = <span class="string">r&#x27;E:\\Programs\\python\\è‡ªåŠ¨åŒ–å¤„ç†EXEL\\test.xlsx&#x27;</span></span><br><span class="line">xlwb = xlApp.Workbooks.Open(Filename=filename)  <span class="comment"># è·å–å·¥ä½œç°¿</span></span><br><span class="line"><span class="built_in">print</span>(xlwb)</span><br><span class="line"><span class="built_in">print</span>(xlwb.Sheets(<span class="number">1</span>).Cells(<span class="number">1</span>, <span class="number">1</span>))  <span class="comment"># æ‰“å°ç¬¬ä¸€å¼ å·¥ä½œè¡¨çš„A1å•å…ƒæ ¼çš„å€¼</span></span><br><span class="line">xlApp.Quit()</span><br></pre></td></tr></table></figure>



<span id="more"></span>



<p>é”™è¯¯ä¿¡æ¯å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">&quot;D:\Program Files\Python39\lib\site-packages\win32com\client\dynamic.py&quot;</span>, line <span class="number">81</span>, <span class="keyword">in</span> _GetGoodDispatch</span><br><span class="line">    IDispatch = pythoncom.connect(IDispatch)</span><br><span class="line">pywintypes.com_error: (-<span class="number">2147221021</span>, <span class="string">&#x27;æ“ä½œæ— æ³•ä½¿ç”¨&#x27;</span>, <span class="literal">None</span>, <span class="literal">None</span>)</span><br><span class="line"></span><br><span class="line">During handling of the above exception, another exception occurred:</span><br><span class="line"></span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">&quot;E:\Programs\python\è‡ªåŠ¨åŒ–å¤„ç†EXEL\è¯»å–æ–‡ä»¶.py&quot;</span>, line <span class="number">298</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">    test_001()</span><br><span class="line">  File <span class="string">&quot;E:\Programs\python\è‡ªåŠ¨åŒ–å¤„ç†EXEL\è¯»å–æ–‡ä»¶.py&quot;</span>, line <span class="number">252</span>, <span class="keyword">in</span> test_001</span><br><span class="line">    xlApp = win32com.client.gencache.EnsureDispatch(<span class="string">&#x27;Excel.Application&#x27;</span>)</span><br><span class="line">  File <span class="string">&quot;D:\Program Files\Python39\lib\site-packages\win32com\client\gencache.py&quot;</span>, line <span class="number">524</span>, <span class="keyword">in</span> EnsureDispatch</span><br><span class="line">    disp = win32com.client.Dispatch(prog_id)</span><br><span class="line">  File <span class="string">&quot;D:\Program Files\Python39\lib\site-packages\win32com\client\__init__.py&quot;</span>, line <span class="number">95</span>, <span class="keyword">in</span> Dispatch</span><br><span class="line">    dispatch, userName = dynamic._GetGoodDispatchAndUserName(dispatch,userName,clsctx)</span><br><span class="line">  File <span class="string">&quot;D:\Program Files\Python39\lib\site-packages\win32com\client\dynamic.py&quot;</span>, line <span class="number">98</span>, <span class="keyword">in</span> _GetGoodDispatchAndUserName</span><br><span class="line">    <span class="keyword">return</span> (_GetGoodDispatch(IDispatch, clsctx), userName)</span><br><span class="line">  File <span class="string">&quot;D:\Program Files\Python39\lib\site-packages\win32com\client\dynamic.py&quot;</span>, line <span class="number">83</span>, <span class="keyword">in</span> _GetGoodDispatch</span><br><span class="line">    IDispatch = pythoncom.CoCreateInstance(IDispatch, <span class="literal">None</span>, clsctx, pythoncom.IID_IDispatch)</span><br><span class="line">pywintypes.com_error: (-<span class="number">2147467262</span>, <span class="string">&#x27;ä¸æ”¯æŒæ­¤æ¥å£&#x27;</span>, <span class="literal">None</span>, <span class="literal">None</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="å¼€å§‹æ’æŸ¥é—®é¢˜"><a href="#å¼€å§‹æ’æŸ¥é—®é¢˜" class="headerlink" title="å¼€å§‹æ’æŸ¥é—®é¢˜"></a>å¼€å§‹æ’æŸ¥é—®é¢˜</h3><p>è¿™ä¸ªç©æ„å„¿ç«Ÿç„¶èŠ±äº†æˆ‘5hæ—¶é—´ï¼ï¼ï¼</p>
<ol>
<li>é¦–å…ˆï¼Œæˆ‘é€šè¿‡æ–­ç‚¹è°ƒè¯•æ‰¾åˆ°ï¼š</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># D:\Program Files\Python39\Lib\site-packages\win32com\client\dynamic.py</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_GetGoodDispatch</span>(<span class="params">IDispatch, clsctx = pythoncom.CLSCTX_SERVER</span>):</span></span><br><span class="line">	<span class="comment"># quick return for most common case</span></span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">isinstance</span>(IDispatch, PyIDispatchType):</span><br><span class="line">		<span class="keyword">return</span> IDispatch</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">isinstance</span>(IDispatch, _GoodDispatchTypes):</span><br><span class="line">		<span class="keyword">try</span>:</span><br><span class="line">			IDispatch = pythoncom.connect(IDispatch)</span><br><span class="line">		<span class="keyword">except</span> pythoncom.ole_error:</span><br><span class="line">			IDispatch = pythoncom.CoCreateInstance(IDispatch, <span class="literal">None</span>, clsctx, pythoncom.IID_IDispatch)  <span class="comment"># æ–­ç‚¹æœ€ç»ˆåœåœ¨è¿™é‡Œè¿‡ä¸å»</span></span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		<span class="comment"># may already be a wrapped class.</span></span><br><span class="line">		IDispatch = <span class="built_in">getattr</span>(IDispatch, <span class="string">&quot;_oleobj_&quot;</span>, IDispatch)</span><br><span class="line">	<span class="keyword">return</span> IDispatch</span><br><span class="line">	</span><br><span class="line"><span class="comment"># è¿›ä¸€æ­¥çœ‹pythoncom.pyå’Œpywintypes.pyæ–‡ä»¶ï¼Œä¹Ÿæ²¡çœ‹å‡ºæ˜¯å•¥é—®é¢˜</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ol start="2">
<li><p>å¼€å§‹æŸ¥æ‰¾ç™¾åº¦</p>
<p>â€‹        åœ¨ç™¾åº¦ä¸Šçœ‹åˆ°æ­¤é—®é¢˜éƒ½æ˜¯2017å¹´ä¹‹å‰çš„å›ç­”ï¼Œå¾ˆæ˜¾ç„¶ï¼Œå¤§å®¶éƒ½æ”¾å¼ƒwin32comè¯»å–exelè¿™ç§è€åŠæ³•äº†ï¼Œè¦ä¸æˆ‘æ‰‹å¤´ä¸Šä¸ªåˆ«æ–‡ä»¶éœ€è¦è¿™ä¸ªï¼Œæˆ‘ä¹Ÿæ˜¯æ›´å–œæ¬¢ä½¿ç”¨pandaså’Œopenpyxlæ¥ç€ï¼Œå“¼ï¼</p>
<p>â€‹        å¤§å®¶çš„ç­”æ¡ˆå¤§æ¦‚æ€»ç»“ä¸ºä»¥ä¸‹å‡ ä¸ªï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span> ï¼ˆå…ˆè¯´ä¸€ä¸‹ï¼Œè¿™ä¸ªæ˜¯æœ€å‘çš„åŠæ³•ï¼ï¼ï¼ï¼‰</span><br><span class="line">	æœ‰äº›äººè¯´ï¼Œç¬¬ä¸€å¥è¯ä½¿ç”¨ä¸‹é¢è¿™ä¸ªä»£æ›¿ï¼Œä¸win32com.client.Dispatch()æœ‰ç‚¹åŒºåˆ«ï¼Œä½¿ç”¨ä¸­æ³¨æ„å°±è¡Œ</span><br><span class="line">excel_APP = win32com.client.gencache.EnsureDispatch(<span class="string">&#x27;Excel.Application&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>â€‹        <strong>ä¸Šé¢è¿™ä¸ªæ–¹æ³•æ˜¯å‘ä¸­ä¹‹å‘ï¼</strong>æˆ‘ä½¿ç”¨ä¸Šé¢é‚£å¥ä»£æ›¿ä»¥åï¼Œé—®é¢˜ä¾æ—§åœ¨ï¼Œå¼€å§‹å¾€æ·±æ¸Šç»§ç»­æ¢ç´¢ï¼</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2.</span> æœ‰äº›äººè¯´æ£€æŸ¥EXELæœ‰æ²¡æœ‰æ³¨å†ŒdcomæœåŠ¡ï¼š</span><br><span class="line">é€šè¿‡dcom.cnfgå’Œregeditæ¥æ£€æµ‹å’Œä¿®æ”¹</span><br><span class="line"></span><br><span class="line"><span class="number">3.</span> æœ‰äº›äººè¯´dcomä¸­exel Applicationçš„æƒé™è®¾ç½®ä¿®æ”¹ä¸€ä¸‹ï¼Œ</span><br><span class="line">é€šè¿‡å±æ€§-&gt;å®‰å…¨</span><br><span class="line"></span><br><span class="line"><span class="number">4.</span> æœ‰äº›äººè¯´åˆ é™¤gen_py</span><br><span class="line">ä½ç½®ï¼šC:\Users\XXX\AppData\Local\Temp\gen_py</span><br><span class="line"></span><br><span class="line"><span class="number">5.</span> æœ‰äººè¯´é‡æ–°è¿è¡Œä¸€ä¸‹makepy.py(éœ€è¦å®‰è£…win32gui,é‡Œé¢é€‰æ‹©exelæœåŠ¡)</span><br><span class="line">ä½ç½®ï¼šD:\Program Files\Python39\Lib\site-packages\win32com\client\makepy.py</span><br><span class="line">    </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>â€‹        ä¸Šé¢è¿™äº›å¯èƒ½å¯¹éƒ¨åˆ†äººæœ‰ç”¨ï¼Œä½†æ˜¯æˆ‘çš„ç¨‹åºæ˜¨å¤©è¿˜å¥½å¥½çš„å•Šï¼å½“ç„¶ï¼Œè¿™äº›ä¸œè¥¿ç…§åšäº†ï¼Œä¹Ÿæ²¡å¥½ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">6.</span> åœ¨stackoverflow.comä¸Šç»§ç»­æŸ¥ï¼ŒæŸ¥åˆ°æœ‰äººè¯´å¯èƒ½æ˜¯pythonå’Œwindowsç³»ç»Ÿéƒ½å¾—æ˜¯<span class="number">32</span>ä½æ‰å¯ä»¥ã€‚</span><br><span class="line">ã€‚ã€‚ã€‚ã€‚ã€‚</span><br><span class="line">æˆ‘æ˜¨å¤©å¥½å¥½çš„å¤§å“¥ï¼</span><br><span class="line">æˆ‘python <span class="number">3.9</span> + Win10 Windows <span class="number">10</span> ä¼ä¸šç‰ˆ 20H <span class="number">64</span>ä½ + Office <span class="number">2016</span> <span class="number">64</span>ä½</span><br><span class="line"></span><br><span class="line">æˆ‘è¯•ç€å¸è½½pywin32,é‡è£…ï¼Œè£…äº†æœ€æ–°ç‰ˆpywin32-<span class="number">301.</span>win-amd64-py3<span class="number">.9</span>.exe</span><br><span class="line">ç½‘å€ï¼šhttps://github.com/mhammond/pywin32/releases</span><br><span class="line">	ä¹Ÿä¸æ¯«æ²¡ç”¨</span><br><span class="line">	æ­¤æ—¶å·²åˆ°ä¸­åˆåƒé¥­æ—¶é—´ï¼Œä¸­åˆåƒé¥­æ—¶è„‘å­è¿˜æ˜¯éå¸¸çš„ä¹±ï¼è„–å­ä¹Ÿå› ä¸ºä¸€ä¸Šåˆç´§ç›¯ç€å±å¹•æ²¡åŠ¨è¿‡è€Œç–¼å¾—è¦å‘½...</span><br><span class="line"></span><br><span class="line"><span class="number">7.</span> è¦åŠ ä¸€ä¸ªtime.sleep(<span class="number">0.5</span>)å·²è§£å†³åŠ è½½ç¼“æ…¢çš„é—®é¢˜</span><br><span class="line">	è¿™ä¸ªåœ¨æˆåŠŸå»ºç«‹xlAPPä»¥åï¼Œåœ¨åç»­ä½¿ç”¨ä¸­éœ€è¦æ³¨æ„åŠ è½½ç¼“æ…¢çš„æƒ…å†µï¼Œç°åœ¨æˆ‘é‡åˆ°çš„é—®é¢˜æ˜¯æ ¹æœ¬è¿˜æ²¡å¼€å§‹æ‰“å¼€exelåº”ç”¨æœåŠ¡ï¼</span><br></pre></td></tr></table></figure>

<p>â€‹        ä¸‹åˆå¼€å§‹æ·±ç©¶é—®é¢˜çš„åŸå› ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">å‘ç°ç½‘ä¸Šå¤§å®¶å‡ºç°çš„é—®é¢˜è¯•ä»¥ä¸‹å‡ ä¸ªç±»å‹ï¼š</span><br><span class="line">aï¼‰ç¯å¢ƒé—®é¢˜</span><br><span class="line">b) ç¬¬ä¸‰æ–¹åº“é—®é¢˜</span><br><span class="line">c) è¦è¯»å–çš„.xlsxæ–‡ä»¶è·¯å¾„ã€åç§°ç­‰çš„é—®é¢˜ï¼ˆæˆ‘å¼€å§‹æ€€ç–‘æˆ‘å½“åˆæ˜¯ä¸æ˜¯è¿™ä¸ªé—®é¢˜ï¼‰ </span><br><span class="line">d) win32com.client.Dispatchå’Œwin32com.client.gencache.EnsureDispatchè¿™ä¸¤ä¸ªçš„åŒºåˆ«ï¼Œå¾ˆæ˜¾ç„¶ï¼Œå¦‚æœä½¿ç”¨çš„åè€…ï¼Œå› äºŒè€…ä½¿ç”¨çš„è¯­æ³•å¤§å°å†™ä¸ä¸€æ ·ï¼Œå¯¼è‡´makepy.pyç”Ÿæˆçš„dcomæ˜ å°„è¯»ä¸åˆ°â€œEXEL.Applicationâ€, æˆ‘ä¸Šåˆè¸©å¾—å‘å°±æ˜¯è¿™ä¸ª</span><br></pre></td></tr></table></figure>

<p>â€‹        </p>
</li>
</ol>
<h4 id="è§£å†³bug"><a href="#è§£å†³bug" class="headerlink" title="è§£å†³bug"></a>è§£å†³bug</h4><p>çœ‹åˆ°ç½‘ä¸Šå¥½å¤šäººéƒ½è§£å†³ä¸äº†é—®é¢˜ï¼Œæ”¾å¼ƒäº†python+win32comè¿™æ¡ä¸¤è·¯çº¿ï¼Œç„¶è€Œæˆ‘ä¸ä¼šé‚£ä¹ˆè½»æ˜“æ”¾å¼ƒï¼</p>
<p>ç»è¿‡è·Ÿè¸ªæºç ï¼Œå‘ç°ï¼š</p>
<p><strong>Dispatch()é™¤äº†gencache.EnsureDispatch()ä»¥å¤–ï¼Œè¿˜æœ‰ä¸¤ä¸ªå‡½æ•°å¯ä»¥æ›¿ä»£å®ƒï¼Œäºæ˜¯å¼€å§‹å°è¯•ï¼š</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DispatchEx()å’ŒCDispatch()</span><br></pre></td></tr></table></figure>

<p>å‰è€…ç›´æ¥è§£å†³äº†æˆ‘ä»Šå¤©çš„é—®é¢˜ï¼</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xlApp = win32com.client.DispatchEx(<span class="string">&#x27;Excel.Application&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><strong>ä½¿ç”¨è¿™å¥ä»£æ›¿åå±…ç„¶ç¥å¥‡çš„å¥½äº†ï¼ï¼ï¼</strong></p>
<p>ç½‘ä¸Šæœäº†ä¸€ä¸‹åŒºåˆ«ï¼Œä¹Ÿå°±æ‰¾åˆ°ä¸€ä¸ªè®¨è®º <a target="_blank" rel="noopener" href="https://oomake.com/question/5339468">https://oomake.com/question/5339468</a></p>
<p>å¤§æ¦‚æ„æ€æ˜¯ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">å¦‚æœExcelå·²æ‰“å¼€ï¼Œä½¿ç”¨dispatchå°†åœ¨æ‰“å¼€çš„Excelå®ä¾‹ä¸­åˆ›å»ºæ–°é€‰é¡¹å¡ï¼›è€Œä½¿ç”¨dispatchExå°†æ‰“å¼€ä¸€ä¸ªæ–°çš„Excelå®ä¾‹ã€‚</span><br><span class="line">DispatchExå¯èƒ½ç”¨äºè¿œç¨‹è®¿é—®ã€‚</span><br><span class="line"></span><br><span class="line">ä»the pywin32 sourceï¼Œæ‚¨å¯ä»¥çœ‹åˆ°DispatchExå°è¯•è¿”å›ä¸€ä¸ªåŒ…è£¹çš„IDispatchExæ¥å£è€Œä¸æ˜¯IDispatchã€‚ (è€ƒè™‘åˆ°åå­—ï¼Œè¿™å¹¶ä¸å¤ªä»¤äººæƒŠè®¶ã€‚) ä½ å¯ä»¥åœ¨MSDNä¸ŠæŸ¥æ‰¾IDispatchExï¼Œä½ ä¼šå‘ç°å®ƒæ˜¯</span><br><span class="line"></span><br><span class="line">an extension of the IDispatch interface, supports features appropriate <span class="keyword">for</span> dynamic languages such <span class="keyword">as</span> scripting languages.</span><br><span class="line">è¿™ä¸ªæƒ³æ³•æ˜¯ï¼Œå¦‚æœä½ è‡ªåŠ¨åŒ–çš„ä¸œè¥¿æ˜¯ä¸€ä¸ªåŠ¨æ€å¯¹è±¡(å°±åƒä½ åœ¨Pythonæˆ–Javascriptä¸­é‚£æ ·çš„å¯¹è±¡)ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªé™æ€å¯¹è±¡(å°±åƒä½ åœ¨C++æˆ–Javaä¸­æ‹¥æœ‰çš„é‚£ç§å¯¹è±¡)ï¼ŒVisualåŸºæœ¬ä»£ç å¯ä»¥è®¿é—®å…¶åŠ¨æ€æ€§è´¨ - åœ¨è¿è¡Œæ—¶æšä¸¾ï¼Œæ·»åŠ å’Œåˆ é™¤æˆå‘˜ç­‰ã€‚ å½“ç„¶pywin32å‡ ä¹å¯ä»¥å®ŒæˆVBçš„æ‰€æœ‰å·¥ä½œï¼Œæœ‰æ—¶ä½ éœ€è¦æ›´åŠ æ˜ç¡®ä¸€äº›ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨éœ€è¦åˆ›å»ºä¸€ä¸ªDispatchExï¼Œå¹¶è°ƒç”¨å…¶DeleteMemberByNameç­‰æ–¹æ³•ã€‚</span><br></pre></td></tr></table></figure>

<p>çœ‹æ¥DispatchExæ˜¯æ‰©å±•ç‰ˆï¼Œèƒ½å»ºå¤šä¸ªwin32comæœåŠ¡å¯¹è±¡ã€‚</p>
<p><strong>è¿˜æœ‰ä¸ªç¥å¥‡çš„äº‹æƒ…ï¼š</strong></p>
<p>å½“æˆ‘ç”¨ DispatchEx() æˆåŠŸæ‰“å¼€exelä»¥åï¼Œ<strong>å†ç”¨ Dispach() å’Œgencache.EnsureDispatch()å±…ç„¶ä¹Ÿå¯ä»¥æ‰“å¼€äº†ï¼Œä½†è¿‡ä¸€ä¼šå„¿åˆæ‰“ä¸å¼€äº†â€¦</strong></p>
<p>ä¸è¿‡ä½¿ç”¨DispatchExå±¡è¯•å±¡çˆ½ï¼Œæ²¡å‡ºè¿‡é—®é¢˜ã€‚</p>
<h4 id="ç»§ç»­æ¢ç´¢"><a href="#ç»§ç»­æ¢ç´¢" class="headerlink" title="ç»§ç»­æ¢ç´¢"></a>ç»§ç»­æ¢ç´¢</h4><p>é’ˆå¯¹ä¸‰ä¸ªå‡½æ•°çš„åŒºåˆ«ï¼Œæˆ‘å‘ç°æœ€å¤§çš„åŒºåˆ«å°±æ˜¯ï¼š DispatchEx() ä¼šæ–°å»ºwin32com.client ï¼Œå³æ–°çš„å®¢æˆ·ç«¯æœåŠ¡ï¼Œæˆ‘çš„ä»£ç é‡Œæ˜¯æ–°çš„Excel.Applicationï¼›è€Œåè€…åˆ™ä½¿ç”¨å½“å‰ç³»ç»Ÿè¿›ç¨‹ä¸­çš„Excel.ApplicationæœåŠ¡ã€‚</p>
<p><strong>é‚£ä¹ˆå¦‚æœæˆ‘ç”¨ä»»åŠ¡ç®¡ç†å™¨å…³é—­å½“å‰æ‰€æœ‰Microsoft Excelè¿›ç¨‹ï¼Œåä¸¤è€…æ˜¯ä¸æ˜¯æ²¡åŠæ³•è¿è¡Œå•¦ï¼Ÿ</strong></p>
<p><strong>æ˜¯æ»´ï¼ï¼ï¼ï¼</strong></p>
<p><strong>æœç„¶è¿è¡Œå¤±è´¥ï¼Œè€Œä¸”å‡ºç°çš„é”™è¯¯æç¤ºæ­£æ˜¯æˆ‘ä»Šå¤©ä¸€ç›´åœ¨è§£å†³çš„BUGï¼</strong></p>
<p><strong>æ‰€ä»¥è¯´ï¼Œæˆ‘ä»Šå¤©æ—©ä¸Šç¬¬ä¸€æ¬¡å‡ºç°é—®é¢˜ï¼Œæœ‰å¯èƒ½æ˜¯æ–‡ä»¶åé”™è¯¯ï¼Œè·Ÿå¤§å¯èƒ½æ˜¯æˆ‘åˆšå¼€æœºå°±è¿è¡Œæˆ‘çš„ä»£ç ï¼Œæ²¡æœ‰Microsoft ExcelæœåŠ¡è¿›ç¨‹ï¼Œæ‰€ä»¥ç”¨pywin32è·å–ä¸åˆ°Excel.ApplicationæœåŠ¡ï¼</strong></p>
<p><strong>åšä¸ªå®éªŒéªŒè¯ä¸€ä¸‹ï¼Ÿ</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> win32com.client</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test_01</span>():</span></span><br><span class="line">    xlApp = win32com.client.DispatchEx(<span class="string">&#x27;Excel.Application&#x27;</span>) </span><br><span class="line">    filename = <span class="string">r&#x27;E:\\Programs\\python\\è‡ªåŠ¨åŒ–å¤„ç†EXEL\\test.xlsx&#x27;</span></span><br><span class="line">    xlwb = xlApp.Workbooks.Open(Filename=filename) </span><br><span class="line">    <span class="built_in">print</span>(xlwb)</span><br><span class="line">    <span class="built_in">print</span>(xlwb.Sheets(<span class="number">1</span>).Cells(<span class="number">1</span>, <span class="number">1</span>))  <span class="comment"># æ‰“å°ç¬¬ä¸€å¼ å·¥ä½œè¡¨çš„A1å•å…ƒæ ¼çš„å€¼</span></span><br><span class="line">    <span class="comment"># xlApp.Quit()</span></span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test_02</span>():</span></span><br><span class="line">	xlApp = win32com.client.Dispatch(<span class="string">&#x27;Excel.Application&#x27;</span>)  </span><br><span class="line">    filename = <span class="string">r&#x27;E:\\Programs\\python\\è‡ªåŠ¨åŒ–å¤„ç†EXEL\\test.xlsx&#x27;</span></span><br><span class="line">    xlwb = xlApp.Workbooks.Open(Filename=filename)  </span><br><span class="line">    <span class="built_in">print</span>(xlwb)</span><br><span class="line">    <span class="built_in">print</span>(xlwb.Sheets(<span class="number">1</span>).Cells(<span class="number">1</span>, <span class="number">1</span>))  <span class="comment"># æ‰“å°ç¬¬ä¸€å¼ å·¥ä½œè¡¨çš„A1å•å…ƒæ ¼çš„å€¼</span></span><br><span class="line">    <span class="comment"># xlApp.Quit()</span></span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test_03</span>():</span></span><br><span class="line">	xlApp = win32com.client.gencache.EnsureDispatch(<span class="string">&#x27;Excel.Application&#x27;</span>) </span><br><span class="line">    filename = <span class="string">r&#x27;E:\\Programs\\python\\è‡ªåŠ¨åŒ–å¤„ç†EXEL\\test.xlsx&#x27;</span></span><br><span class="line">    xlwb = xlApp.Workbooks.Open(Filename=filename) </span><br><span class="line">    <span class="built_in">print</span>(xlwb)</span><br><span class="line">    <span class="built_in">print</span>(xlwb.Sheets(<span class="number">1</span>).Cells(<span class="number">1</span>, <span class="number">1</span>))  <span class="comment"># æ‰“å°ç¬¬ä¸€å¼ å·¥ä½œè¡¨çš„A1å•å…ƒæ ¼çš„å€¼</span></span><br><span class="line">    <span class="comment"># xlApp.Quit()</span></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># test_01()</span></span><br><span class="line">    <span class="comment"># test_02()</span></span><br><span class="line">    <span class="comment"># test_03()</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="literal">True</span>):</span><br><span class="line">        test_01()</span><br><span class="line">        <span class="comment"># test_02()</span></span><br><span class="line">        <span class="comment"># test_03()</span></span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>




<table>
<thead>
<tr>
<th align="center">å®éªŒæ‰¹æ¬¡</th>
<th align="center">å®éªŒè¿‡ç¨‹</th>
<th align="center">å®éªŒç»“æœ</th>
</tr>
</thead>
<tbody><tr>
<td align="center">ä¸€</td>
<td align="center">åˆ©ç”¨ä»»åŠ¡ç®¡ç†å™¨å…³é—­æ‰€æœ‰Microsoft Excelè¿›ç¨‹ï¼Œåˆ†åˆ«è¿è¡Œtest_01()ã€test_02()ã€test_03()</td>
<td align="center">åªæœ‰test_01()æˆåŠŸï¼Œåä¸¤è€…å¾—åˆ°ä»Šå¤©çš„å¼€å¤´çš„é‚£ä¸ªbugï¼Œå³æ— æ³•è‡ªå·±åˆ›å»ºExcel.ApplicationæœåŠ¡</td>
</tr>
<tr>
<td align="center">äºŒ</td>
<td align="center">ç”¨é¼ æ ‡éšä¾¿ç‚¹å¼€ä¸€ä¸ªç”µè„‘ä¸Šçš„.xlsxæ–‡ä»¶ï¼Œæ­¤æ—¶ä»»åŠ¡ç®¡ç†å™¨ä¸­å¢åŠ ä¸€ä¸ªMicrosoft Excelè¿›ç¨‹ã€‚è¿›è€Œåˆ†åˆ«è¿è¡Œtest_01()ã€test_02()ã€test_03()</td>
<td align="center">test_01()ã€test_02()ã€test_03()éƒ½å¯æ­£å¸¸è¿è¡Œã€‚ä»»åŠ¡ç®¡ç†å™¨ä¸­çš„æƒ…å†µåˆ†ä¸¤ç§ï¼šï¼ˆ1ï¼‰è‹¥æå‰æ‰“å¼€çš„.xlsxå’Œæµ‹è¯•çš„æ–‡ä»¶æ˜¯ä¸€ä¸ªï¼Œé‚£ä¹ˆtest_01()å¢åŠ ä¸€ä¸ªè¿›ç¨‹ï¼Œåä¸¤è€…ä¸å¢åŠ è¿›ç¨‹ï¼›ï¼ˆ2ï¼‰è‹¥è‹¥æå‰æ‰“å¼€çš„.xlsxä¸ºä»»æ„æ–‡ä»¶ï¼Œå’Œæµ‹è¯•çš„æ–‡ä»¶æ˜¯ä¸ä¸€æ ·ï¼Œåˆ™ä¸‰è€…éƒ½å¢åŠ ä¸€ä¸ªè¿›ç¨‹</td>
</tr>
<tr>
<td align="center">ä¸‰</td>
<td align="center">ç”¨é¼ æ ‡éšä¾¿ç‚¹å¼€ä¸€ä¸ªç”µè„‘ä¸Šçš„.xlsxæ–‡ä»¶ï¼Œæ­¤æ—¶ä»»åŠ¡ç®¡ç†å™¨ä¸­å¢åŠ ä¸€ä¸ªMicrosoft Excelè¿›ç¨‹ã€‚ç„¶ååˆ†åˆ«æ— é™å¾ªç¯è¿è¡Œtest_01()ã€test_02()ã€test_03()</td>
<td align="center">test_01()ã€test_02()ã€test_03()éƒ½å¯æ­£å¸¸è¿è¡Œã€‚åä¸¤è€…ä¸å®éªŒäºŒä¸€è‡´ï¼Œåªå¢åŠ ä¸€ä¸ªè¿›ç¨‹ï¼›è€Œtest-01()åˆ™æ— é™å¢åŠ è¿›ç¨‹ï¼Œæ¯”å¦‚è¾¾åˆ°å¥½å¤šä¸ªMicrosoft Excelè¿›ç¨‹ã€‚</td>
</tr>
<tr>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
</tbody></table>
<p><strong>ç»“æœåˆ†æï¼š</strong></p>
<p>ä¸Šè¿°å®éªŒåŠç»“æœæ˜¾ç¤ºï¼Œæˆ‘çš„çŒœæµ‹æ²¡é”™ï¼Œä¹Ÿè®©æˆ‘ä»Šå¤©çš„æ¢ç´¢ç»ˆäºæœ‰äº†æ¸…æ™°åœ°ç­”æ¡ˆï¼Œç»ˆäºå¯ä»¥å®‰ç¨³åœ°ä½¿ç”¨win32comäº†ï¼ï¼</p>
<p><strong>åœ¨ä»¥åçš„ä½¿ç”¨ä¸­ï¼Œæˆ‘æ›´æƒ³ç”¨xlApp = win32com.client.DispatchEx(â€˜Excel.Applicationâ€™) æ¥åˆ›å»ºExcel.ApplicationæœåŠ¡ï¼Œçœ‹ä»–æ ·å­æœ‰å¯èƒ½è¿˜å¯ä»¥è·¨è®¡ç®—æœºåˆ›å»ºå®ä¾‹ï¼</strong></p>
<p><strong>è¿˜è®°å¾—å¤§äºŒæ—¶é™ˆå®¶éªæ•™æˆè¯´è¿‡ï¼Œä½ å®³æ€•bugå¹²å˜›ï¼Ÿè®¡ç®—æœºæ˜¯æˆ‘ä»¬äººç±»å¼€å‘å‡ºæ¥çš„ï¼Œå®³æ€•å®ƒï¼Ÿåœ¨äººå·¥æ™ºèƒ½è¿˜æœªæˆç†Ÿçš„ç°åœ¨ï¼Œbugå®Œå…¨åªæ˜¯è®¾è®¡ç¼ºé™·è€Œå·²ï¼Œä½ ç¨‹åºå†™æˆæ€ä¹ˆæ ·ï¼Œå®ƒç»™ä½ çš„åé¦ˆå°±é‚£æ ·ï¼ä½ å®Œå…¨æ²¡å¿…è¦æ‹…å¿ƒbugä¼šåå™¬ä½ ï¼Œå“ˆå“ˆï¼</strong></p>
<p>å¯¹å•Šï¼Œç»å¸¸çœ‹åˆ°å‘¨å›´äººä¸€é‡åˆ°é—®é¢˜å°±æ”¾å¼ƒï¼Œæˆ–è€…åŠªåŠ›å°è¯•è§£å†³ä¸€æ®µæ—¶é—´åä»ä¼šé€‰æ‹©æ”¾å¼ƒï¼Œè€Œæˆ‘æ˜¯é‚£ä¸ªå–œæ¬¢é’»ç ”é—®é¢˜çš„æœ¬è´¨ï¼Œå°½æœ€å¤§èƒ½åŠ›è§£å†³çš„äººï¼å°¤å…¶æ˜¯è‡ªå·±å†™çš„ä»£ç å‡ºçš„é—®é¢˜ï¼Œæˆ‘ä¼šæ›´è®¤çœŸé’»ç ”ã€‚</p>
 
      <!-- reward -->
      
      <div id="reword-out">
        <div id="reward-btn">
          æ‰“èµ
        </div>
      </div>
      
    </div>
    

    <!-- copyright -->
    
    <div class="declare">
      <ul class="post-copyright">
        <li>
          <i class="ri-copyright-line"></i>
          <strong>ç‰ˆæƒå£°æ˜ï¼š </strong>
          
          æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œè‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼
          
        </li>
      </ul>
    </div>
    
    <footer class="article-footer">
       
<div class="share-btn">
      <span class="share-sns share-outer">
        <i class="ri-share-forward-line"></i>
        åˆ†äº«
      </span>
      <div class="share-wrap">
        <i class="arrow"></i>
        <div class="share-icons">
          
          <a class="weibo share-sns" href="javascript:;" data-type="weibo">
            <i class="ri-weibo-fill"></i>
          </a>
          <a class="weixin share-sns wxFab" href="javascript:;" data-type="weixin">
            <i class="ri-wechat-fill"></i>
          </a>
          <a class="qq share-sns" href="javascript:;" data-type="qq">
            <i class="ri-qq-fill"></i>
          </a>
          <a class="douban share-sns" href="javascript:;" data-type="douban">
            <i class="ri-douban-line"></i>
          </a>
          <!-- <a class="qzone share-sns" href="javascript:;" data-type="qzone">
            <i class="icon icon-qzone"></i>
          </a> -->
          
          <a class="facebook share-sns" href="javascript:;" data-type="facebook">
            <i class="ri-facebook-circle-fill"></i>
          </a>
          <a class="twitter share-sns" href="javascript:;" data-type="twitter">
            <i class="ri-twitter-fill"></i>
          </a>
          <a class="google share-sns" href="javascript:;" data-type="google">
            <i class="ri-google-fill"></i>
          </a>
        </div>
      </div>
</div>

<div class="wx-share-modal">
    <a class="modal-close" href="javascript:;"><i class="ri-close-circle-line"></i></a>
    <p>æ‰«ä¸€æ‰«ï¼Œåˆ†äº«åˆ°å¾®ä¿¡</p>
    <div class="wx-qrcode">
      <img src="//api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://yeying.tech/%E7%AC%94%E8%AE%B0/interesting-bug/" alt="å¾®ä¿¡åˆ†äº«äºŒç»´ç ">
    </div>
</div>

<div id="share-mask"></div>  
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/" rel="tag">python</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/win32com/" rel="tag">win32com</a></li></ul>

    </footer>
  </div>

   
  <nav class="article-nav">
    
    
      <a href="/%E7%AC%94%E8%AE%B0/Typora-Theme/" class="article-nav-link">
        <strong class="article-nav-caption">ä¸‹ä¸€ç¯‡</strong>
        <div class="article-nav-title">Typoraç¾åŒ–</div>
      </a>
    
  </nav>

   
<!-- valineè¯„è®º -->
<div id="vcomments-box">
  <div id="vcomments"></div>
</div>
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/valine@1.4.14/dist/Valine.min.js"></script>
<script>
  new Valine({
    el: "#vcomments",
    app_id: "",
    app_key: "",
    path: window.location.pathname,
    avatar: "monsterid",
    placeholder: "ç»™æˆ‘çš„æ–‡ç« åŠ ç‚¹è¯„è®ºå§~",
    recordIP: true,
  });
  const infoEle = document.querySelector("#vcomments .info");
  if (infoEle && infoEle.childNodes && infoEle.childNodes.length > 0) {
    infoEle.childNodes.forEach(function (item) {
      item.parentNode.removeChild(item);
    });
  }
</script>
<style>
  #vcomments-box {
    padding: 5px 30px;
  }

  @media screen and (max-width: 800px) {
    #vcomments-box {
      padding: 5px 0px;
    }
  }

  #vcomments-box #vcomments {
    background-color: #fff;
  }

  .v .vlist .vcard .vh {
    padding-right: 20px;
  }

  .v .vlist .vcard {
    padding-left: 10px;
  }
</style>

 
   
     
</article>


</section>
      <footer class="footer">
  <div class="outer">
    <ul>
      <li>
        Copyrights &copy;
        2019-2021
        <i class="ri-heart-fill heart_icon"></i> PAYIZ
      </li>
    </ul>
    <ul>
      <li>
        
        
        <span>
  <span><i class="ri-user-3-fill"></i><span id="busuanzi_value_site_uv"></span></span>
  <span class="division">|</span>
  <span><i class="ri-eye-fill"></i><span id="busuanzi_value_page_pv"></span></span>
</span>
        
      </li>
    </ul>
    <ul>
      
    </ul>
    <ul>
      
    </ul>
    <ul>
      <li>
        <!-- cnzzç»Ÿè®¡ -->
        
        <script type="text/javascript" src='https://s9.cnzz.com/z_stat.php?id=1280147847&amp;web_id=1280147847'></script>
        
      </li>
    </ul>
  </div>
</footer>
      <div class="float_btns">
        <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>

<div class="todark" id="todark">
  <i class="ri-moon-line"></i>
</div>

      </div>
    </main>
    <aside class="sidebar on">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/images/bird.png" alt="å¤œèºæ‚ åŸ"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">ä¸»é¡µ</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">å½’æ¡£</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories">åˆ†ç±»</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags">æ ‡ç­¾</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories/%E7%9B%B8%E5%86%8C">ç›¸å†Œ</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/photos">å£çº¸</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/friends">ç¤¾äº¤</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/about/me">å…³äºæˆ‘</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/about/site">å…³äºåšå®¢</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="æœç´¢">
        <i class="ri-search-line"></i>
      </a>
      
      
      <a class="nav-item-link" target="_blank" href="/atom.xml" title="RSS Feed">
        <i class="ri-rss-line"></i>
      </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>æ„Ÿè°¢æ‚¨çš„æ”¯æŒğŸ˜Š</p>
  <div class="reward-box">
    
    <div class="reward-item">
      <img class="reward-img" src="https://cdn.jsdelivr.net/gh/payiz-asj/CDN/images/alipay.png">
      <span class="reward-type">æ”¯ä»˜å®</span>
    </div>
    
    
    <div class="reward-item">
      <img class="reward-img" src="https://cdn.jsdelivr.net/gh/payiz-asj/CDN/images/wechatpay.png">
      <span class="reward-type">å¾®ä¿¡</span>
    </div>
    
  </div>
</div>
    
<script src="/js/jquery-2.0.3.min.js"></script>
 
<script src="/js/lazyload.min.js"></script>

<!-- Tocbot -->
 
<script src="/js/tocbot.min.js"></script>

<script>
  tocbot.init({
    tocSelector: ".tocbot",
    contentSelector: ".article-entry",
    headingSelector: "h1, h2, h3, h4, h5, h6",
    hasInnerContainers: true,
    scrollSmooth: true,
    scrollContainer: "main",
    positionFixedSelector: ".tocbot",
    positionFixedClass: "is-position-fixed",
    fixedSidebarOffset: "auto",
  });
</script>

<script src="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.js"></script>
<link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.css"
/>
<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js"></script>

<script src="/dist/main.js"></script>

<!-- ImageViewer -->
 <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css">
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // sliderå±•å¼€çŠ¶æ€
                // todo: è¿™æ ·ä¸å¥½ï¼Œåé¢æ”¹æˆçŠ¶æ€
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // è·å¾—åŸå›¾å°ºå¯¸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script> 
<!-- MathJax -->

<!-- Katex -->

<!-- busuanzi  -->
 
<script src="/js/busuanzi-2.3.pure.min.js"></script>
 
<!-- ClickLove -->
 
<script src="/js/clickLove.js"></script>
 
<!-- ClickBoom1 -->

<!-- ClickBoom2 -->

<!-- CodeCopy -->
 
<link rel="stylesheet" href="/css/clipboard.css">
 <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="ri-file-copy-2-line"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-checkbox-circle-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // ç­‰å¾…ä¸¤ç§’é’Ÿåæ¢å¤
          $icon.removeClass('ri-checkbox-circle-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-time-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // ç­‰å¾…ä¸¤ç§’é’Ÿåæ¢å¤
          $icon.removeClass('ri-time-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>
 
<!-- CanvasBackground -->

<script>
  if (window.mermaid) {
    mermaid.initialize({ theme: "forest" });
  }
</script>


    
  </div>
</body>

</html>